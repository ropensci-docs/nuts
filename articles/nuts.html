<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="nuts">
<title>nuts: Convert European Regional Data in R • nuts</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="nuts: Convert European Regional Data in R">
<meta property="og:description" content="nuts">
<meta property="og:image" content="https://docs.ropensci.org/nuts/logo.png">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Mathjax --><script type="text/javascript" id="MathJax-script" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.min.js">
</script><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">nuts</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="active nav-item">
  <a class="nav-link" href="../articles/nuts.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/nuts/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="nuts_files/kePrint-0.0.1/kePrint.js"></script><link href="nuts_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="nuts_files/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet">
<script src="nuts_files/bsTable-3.3.7/bootstrapTable.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>nuts: Convert European Regional Data in R</h1>
                        <h4 data-toc-skip class="author">Moritz Hennicke</h4>
                                    <h4 data-toc-skip class="author">Werner Krause</h4>
                        
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/nuts/blob/HEAD/vignettes/nuts.Rmd" class="external-link"><code>vignettes/nuts.Rmd</code></a></small>
      <div class="d-none name"><code>nuts.Rmd</code></div>
    </div>

    
    
<style type="text/css">
pre code {
  white-space: pre-wrap;
}
</style>
<!-- # Overview --><!-- The `nuts` package simplifies the analysis of European regional data by providing an efficient offline solution for converting data between NUTS versions and levels. Leveraging the methodology and conversion matrices of the European Commission's [Joint Research Center (JRC)](https://urban.jrc.ec.europa.eu/nutsconverter/#/), this package is designed to address the challenges posed by time-varying boundaries of European regions. --><div class="section level2">
<h2 id="key-features">Key Features<a class="anchor" aria-label="anchor" href="#key-features"></a>
</h2>
<div class="float-image">
<p><img src="logo.png" alt="Package logo of a squirrel holdling a walnut colored with the flag of Europe" width="150px" style="float:left; padding:30px"></p>
<ul>
<li><p>Efficient <strong>offline conversion</strong> of European regional data.</p></li>
<li><p>Conversion between five NUTS <strong>versions</strong>: 2006, 2010, 2013, 2016, 2021.</p></li>
<li><p>Conversion between three regional <strong>levels</strong>: NUTS-1, NUTS-2, NUTS-3.</p></li>
<li><p>Ability to convert <strong>multiple</strong> NUTS versions at once when e.g. NUTS versions differ across countries and years. This scenario is common when working with data sourced from EUROSTAT.</p></li>
<li><p>(Dasymetric) <strong>Spatial interpolation</strong> based on five <strong>weights</strong> (regional area size, 2011 and 2018 population size, 2012 and 2018 built-up area) built from granular [100m x 100m] geodata by the European Commission’s <a href="https://urban.jrc.ec.europa.eu/tools/nuts-converter" class="external-link">Joint Research Center (JRC)</a>.</p></li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="nuts-codes">NUTS Codes<a class="anchor" aria-label="anchor" href="#nuts-codes"></a>
</h2>
<p>The Nomenclature of Territorial Units for Statistics (NUTS) is a geocode standard for referencing the administrative divisions of European countries. A NUTS code starts with a two-letter combination indicating the country.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;a href="https://publications.europa.eu/code/en/en-5000600.htm" class="external-link"&gt;European Interinstitutional Style Guide&lt;/a&gt; In the case of Greece for instance this code was changed from GR to EL in 2011.&lt;/p&gt;'><sup>1</sup></a> The administrative subdivisions, or <strong>levels</strong>, are referred to with an additional number or a capital letter (NUTS-1). A second (NUTS-2) or third (NUTS-3) subdivision level is referred to with another digit each.</p>
<p>For example, the German district <em>Northern Saxony</em> (<em>Nordsachsen</em>) is located within the region <em>Leipzig</em> and the federate state Saxony.</p>
<ul>
<li>NUTS-1: States
<ul>
<li>DED: Saxony</li>
</ul>
</li>
<li>NUTS-2: States/Government Regions
<ul>
<li>DED5: Leipzig</li>
</ul>
</li>
<li>NUTS-3: Districts
<ul>
<li>DED53: Northern Saxony</li>
</ul>
</li>
</ul>
<p>Since administrative boundaries in Europe change for demographic, economic, political or other reasons, there are five different <strong>versions</strong> of the NUTS Nomenclature (2006, 2010, 2013, 2016, and 2021). The current version, effective from 1 January 2021, lists 104 regions at NUTS-1, 283 regions at NUTS-2, 1 345 regions at NUTS-3 level<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;a href="https://ec.europa.eu/eurostat/documents/3859598/15193590/KS-GQ-22-010-EN-N.pdf" class="external-link"&gt;2022 report of the European Union&lt;/a&gt;&lt;/p&gt;'><sup>2</sup></a>.</p>
<div class="section level3">
<h3 id="spatial-interpolation-in-a-nutshell">Spatial interpolation in a nutshell<a class="anchor" aria-label="anchor" href="#spatial-interpolation-in-a-nutshell"></a>
</h3>
<p>When administrative units are restructured, regional data measured within old boundaries can be converted to the new boundaries under reasonable assumptions. The main task of this package is to use (<strong>dasymetric</strong>) <strong>spatial interpolation</strong> to accomplish this.</p>
<p>Let’s take the example of the German state Saxony in the figures below. Here, the NUTS-2 regions <em>Leipzig</em> (<code>DED3</code> → <code>DED5</code>) and <em>Chemnitz</em> (<code>DED1</code> → <code>DED4</code>) were reorganized. We are interested in the number of manure storage facilities in 2003 provided by <a href="https://ec.europa.eu/eurostat/databrowser/view/PAT_EP_RTOT/default/table" class="external-link">EUROSTAT</a> based on the 2006 NUTS version. A part of <em>Leipzig</em> was reassigned to <em>Chemnitz</em> (center plot), prompting us to recalculate the number of storage facilities in the 2010 version (right plot).</p>
<p>A simple approach is to redistribute manure storage facilities proportional to the transferred area, assuming equal distribution of manure storages across space. In a dasymetric approach, we could make use of built-up area, assuming that manure deposits are more likely to be found close to residential areas and economic sites. In our example, <em>Leipzig</em> lost about 7.7% (<span class="math inline">\(\frac{5574}{72360}\)</span>) of its built-up area. We re-calculate the number of manure storage facilities by computing 7.7% of <em>Leipzig’s</em> manure storages <span class="math inline">\(\frac{5574}{72360} * 700 = 54\)</span>, subtracting them from Leipzig and adding them to <em>Chemnitz</em>.</p>
<p>See the Section <a href="#method"><em>Spatial interpolation in detail</em></a> for an in-depth description of the weighting procedure.</p>
<div class="figure">
<img src="nuts_files/figure-html/unnamed-chunk-6-1.png" alt="Maps of NUTS 3 regions Chemnitz and Leipzig in NUTS version 2003, between 2003 and 2006 and 2006. They visualize the example in the text in which Chemnitz contributes a part of its area to Leipzig." width="100%"><p class="caption">
Holdings with Manure Storage Facilities; BU = Built-up area in square meters; Sources: <a href="https://ec.europa.eu/eurostat/web/gisco/geodata/reference-data/administrative-units-statistical-units/nuts" class="external-link">Shapefiles</a> and <a href="https://ec.europa.eu/eurostat/databrowser/view/PAT_EP_RTOT/default/table" class="external-link">data</a> are from EUROSTAT; Created using the <a href="https://r-spatial.github.io/sf/" class="external-link">sf</a> package.
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>The package comes with three main functions:</p>
<ul>
<li><p><code><a href="../reference/nuts_classify.html">nuts_classify()</a></code> detects the NUTS version(s) and level(s) of a data set. Its output can be directly fed into the two other functions.</p></li>
<li><p><code><a href="../reference/nuts_convert_version.html">nuts_convert_version()</a></code> converts your data to a desired NUTS version (2006, 2010, 2013, 2016, 2021). This transformation works in any direction.</p></li>
<li><p><code><a href="../reference/nuts_aggregate.html">nuts_aggregate()</a></code> aggregates data to some upper-level NUTS code, i.e., it transforms NUTS-3 data to the NUTS-2 or NUTS-1 level (but not vice versa).</p></li>
</ul>
<div class="section level3">
<h3 id="workflow">Workflow<a class="anchor" aria-label="anchor" href="#workflow"></a>
</h3>
<p>The conversion can only be conducted after classifying the NUTS version(s) and level(s) of your data using the function <code><a href="../reference/nuts_classify.html">nuts_classify()</a></code>. This step ensures the validity and completeness of your NUTS codes before proceeding with the conversion.</p>
<div class="figure" style="text-align: center">
<img src="flow.png" alt="Flow diagram that shows that conversion functions are run after classification." width="60%"><p class="caption">
Sequential workflow to convert regional NUTS data
</p>
</div>
</div>
<div class="section level3">
<h3 id="identifying-nuts-version-and-level">Identifying NUTS version and level<a class="anchor" aria-label="anchor" href="#identifying-nuts-version-and-level"></a>
</h3>
<p>The <code><a href="../reference/nuts_classify.html">nuts_classify()</a></code> function’s main purpose is to find the most suitable NUTS <strong>version</strong> and to identify the <strong>level</strong> of the data set. Below, you see an example using patent application data (per one million inhabitants) for Norway in 2012 at the NUTS-2 level. This data is again provided by <a href="https://ec.europa.eu/eurostat/databrowser/view/PAT_EP_RTOT/default/table?lang=en" class="external-link">EUROSTAT</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/nuts/">nuts</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Loading and subsetting Eurostat data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">patents</span>, package <span class="op">=</span> <span class="st">"nuts"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pat_n2</span> <span class="op">&lt;-</span> <span class="va">patents</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">geo</span><span class="op">)</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span> <span class="co"># NUTS-2 values</span></span>
<span></span>
<span><span class="va">pat_n2_mhab_12_no</span> <span class="op">&lt;-</span> <span class="va">pat_n2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">unit</span> <span class="op">==</span> <span class="st">"P_MHAB"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Patents per one million inhabitants</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">time</span> <span class="op">==</span> <span class="fl">2012</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># 2012</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">geo</span>, <span class="st">"^NO"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>  <span class="co"># Norway</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">unit</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Classifying the Data</span></span>
<span><span class="va">pat_classified</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nuts_classify.html">nuts_classify</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">pat_n2_mhab_12_no</span>,</span>
<span>  nuts_code <span class="op">=</span> <span class="st">"geo"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Classifying version of NUTS codes</span> <span style="color: #00BBBB;">─────────────────────────────────</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #0000BB;">Within </span><span style="color: #BB0000;">groups</span><span style="color: #0000BB;"> defined by </span><span style="color: #BB0000;">country</span><span style="color: #0000BB;">:</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">All NUTS codes can be identified and classified.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #BB0000;">Unique</span><span style="color: #0000BB;"> NUTS version classified.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">No missing NUTS codes.</span></span></span></code></pre>
<p>The function returns a list with three items. These items can be called directly from the output object (<code>data$...</code>) or retrieved using the three helper functions <code><a href="../reference/nuts_get_data.html">nuts_get_data()</a></code>, <code><a href="../reference/nuts_get_version.html">nuts_get_version()</a></code>, and <code><a href="../reference/nuts_get_missing.html">nuts_get_missing()</a></code>.</p>
<ol style="list-style-type: decimal">
<li>The first item gives the <strong>original data set</strong> augmented with the columns <code>from_version</code>, <code>from_level</code>, and <code>country</code>, indicating the NUTS version that best suits the data. All functions of the package always group NUTS codes across <strong>country names</strong> which are automatically generated from the provided NUTS codes.</li>
</ol>
<p>Below, you see that all data entries correspond to the 2016 NUTS version.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># pat_classified$data # Call list item directly or...</span></span>
<span><span class="fu"><a href="../reference/nuts_get_data.html">nuts_get_data</a></span><span class="op">(</span><span class="va">pat_classified</span><span class="op">)</span> <span class="co"># ...use helper function</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 7 × 6</span></span></span>
<span><span class="co">##   from_code from_version from_level country  time values</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> NO01      2016                  2 Norway   <span style="text-decoration: underline;">2</span>012  125. </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> NO02      2016                  2 Norway   <span style="text-decoration: underline;">2</span>012   13.2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> NO03      2016                  2 Norway   <span style="text-decoration: underline;">2</span>012   57.4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> NO04      2016                  2 Norway   <span style="text-decoration: underline;">2</span>012  110. </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> NO05      2016                  2 Norway   <span style="text-decoration: underline;">2</span>012   48.9</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> NO06      2016                  2 Norway   <span style="text-decoration: underline;">2</span>012  145. </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">7</span> NO07      2016                  2 Norway   <span style="text-decoration: underline;">2</span>012   16.5</span></span></code></pre>
<ol start="2" style="list-style-type: decimal">
<li>The second item provides an overview of the share of matching NUTS codes for each of the five existing NUTS versions. The <strong>overlap</strong> is computed within country and possibly additional groups (if provided via the <code>group_vars</code> argument).</li>
</ol>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># pat_classified$versions_data # Call list item directly or...</span></span>
<span><span class="fu"><a href="../reference/nuts_get_version.html">nuts_get_version</a></span><span class="op">(</span><span class="va">pat_classified</span><span class="op">)</span> <span class="co"># ...use helper function</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 5 × 3</span></span></span>
<span><span class="co">##   from_version country overlap_perc</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 2016         Norway         100  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 2013         Norway         100  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> 2010         Norway         100  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> 2006         Norway         100  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> 2021         Norway          42.9</span></span></code></pre>
<ol start="3" style="list-style-type: decimal">
<li>The third item gives all NUTS codes that are <strong>missing</strong> across groups. Such missing codes might lead to conversion errors and are, by default, omitted from all conversion procedures. In our example, no NUTS codes are missing. <!-- We recommend to check whether missing values for these NUTS codes can be replaced, perhaps with 0.  -->
</li>
</ol>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># pat_classified$missing_data # Call list item directly or...</span></span>
<span><span class="fu"><a href="../reference/nuts_get_missing.html">nuts_get_missing</a></span><span class="op">(</span><span class="va">pat_classified</span><span class="op">)</span> <span class="co"># ...use helper function</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 0 × 4</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 4 variables: from_code &lt;chr&gt;, from_version &lt;chr&gt;,</span></span></span>
<span><span class="co">## <span style="color: #949494;">#   from_level &lt;dbl&gt;, country &lt;chr&gt;</span></span></span></code></pre>
</div>
<div class="section level3">
<h3 id="converting-data-between-nuts-versions">Converting data between NUTS versions<a class="anchor" aria-label="anchor" href="#converting-data-between-nuts-versions"></a>
</h3>
<p>Once the NUTS version and level of the original data are identified, you can easily <strong>convert</strong> the data to any other <strong>NUTS version</strong>. Here is an example of transforming the 2013 Norwegian data to the 2021 NUTS version. Between 2016 and 2021, the number of NUTS-2 regions in Norway decreased by one as the borders of six regions were transformed. The maps below show the affected regions. We provide the classified NUTS data, specify the target NUTS version for data transformation, and supply the variable containing the values to be interpolated. It is important to indicate the <strong>variable type</strong> in the named input-vector since the interpolation approaches differ for <a href="https://urban.jrc.ec.europa.eu/nutsconverter/docs/2022_08_04_NUTS_converter.pdf" class="external-link">absolute and relative values</a>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Converting Data to 2021 NUTS version</span></span>
<span><span class="va">pat_converted</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nuts_convert_version.html">nuts_convert_version</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">pat_classified</span>,</span>
<span>  to_version <span class="op">=</span> <span class="st">"2021"</span>,</span>
<span>  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"values"</span> <span class="op">=</span> <span class="st">"relative"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Converting version of NUTS codes</span> <span style="color: #00BBBB;">──────────────────────────────────</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #0000BB;">Within </span><span style="color: #BB0000;">groups</span><span style="color: #0000BB;"> defined by </span><span style="color: #BB0000;">country</span><span style="color: #0000BB;">:</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> <span style="color: #0000BB;">Converting NUTS codes in 1 version </span><span style="color: #BB0000;">2016</span><span style="color: #0000BB;"> to version </span><span style="color: #BB0000;">2021</span><span style="color: #0000BB;">.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">All NUTS codes can be converted.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">Version is </span><span style="color: #BB0000;">unique</span><span style="color: #0000BB;">.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">No </span><span style="color: #BB0000;">missing</span><span style="color: #0000BB;"> NUTS codes.</span></span></span></code></pre>
<div class="figure">
<img src="nuts_files/figure-html/unnamed-chunk-14-1.png" alt="Two maps of patents per 1M habitants in Norwegian NUTS 2 regions in NUTS version 2016 and converted to NUTS version 2021" width="100%"><p class="caption">
Converting patent data between versions; Sources: <a href="https://ec.europa.eu/eurostat/web/gisco/geodata/reference-data/administrative-units-statistical-units/nuts" class="external-link">Shapefiles</a> and <a href="https://ec.europa.eu/eurostat/databrowser/view/PAT_EP_RTOT/default/table?lang=en" class="external-link">data</a> are from EUROSTAT; Created using the <a href="https://r-spatial.github.io/sf/" class="external-link">sf</a> package.
</p>
</div>
<p>The output below displays the corresponding data frames based on the original and converted NUTS codes. The original data set comprises of seven observations, whereas the converted data set contains six. The regions <code>NO01</code>, <code>NO03</code>, <code>NO04</code>, and <code>NO05</code> are lost, while <code>NO08</code>, <code>NO09</code>, and <code>NO0A</code> are now listed.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pat_n2_mhab_12_no</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 7 × 3</span></span></span>
<span><span class="co">##   geo    time values</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> NO01   <span style="text-decoration: underline;">2</span>012  125. </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> NO02   <span style="text-decoration: underline;">2</span>012   13.2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> NO03   <span style="text-decoration: underline;">2</span>012   57.4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> NO04   <span style="text-decoration: underline;">2</span>012  110. </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> NO05   <span style="text-decoration: underline;">2</span>012   48.9</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> NO06   <span style="text-decoration: underline;">2</span>012  145. </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">7</span> NO07   <span style="text-decoration: underline;">2</span>012   16.5</span></span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pat_converted</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">##   to_code to_version country values</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> NO02    2021       Norway    13.2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> NO06    2021       Norway   143. </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> NO07    2021       Norway    16.5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> NO08    2021       Norway    71.0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> NO09    2021       Norway    83.0</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> NO0A    2021       Norway    58.9</span></span></code></pre>
<div class="section level4">
<h4 id="converting-multiple-variables-simultaneously">Converting multiple variables simultaneously<a class="anchor" aria-label="anchor" href="#converting-multiple-variables-simultaneously"></a>
</h4>
<p>You can also convert <strong>multiple variables</strong> at once. Below, we add the number of patent applications per 1000 inhabitants as a second variable:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Converting Multiple Variables</span></span>
<span><span class="va">pat_n2_mhab_12_no</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>values_per_thous <span class="op">=</span> <span class="va">values</span> <span class="op">*</span> <span class="fl">1000</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/nuts_classify.html">nuts_classify</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">.</span>,</span>
<span>    nuts_code <span class="op">=</span> <span class="st">"geo"</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/nuts_convert_version.html">nuts_convert_version</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">.</span>,</span>
<span>    to_version <span class="op">=</span> <span class="st">"2021"</span>,</span>
<span>    variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"values"</span> <span class="op">=</span> <span class="st">"relative"</span>,</span>
<span>                  <span class="st">"values_per_thous"</span> <span class="op">=</span> <span class="st">"relative"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Classifying version of NUTS codes</span> <span style="color: #00BBBB;">─────────────────────────────────</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #0000BB;">Within </span><span style="color: #BB0000;">groups</span><span style="color: #0000BB;"> defined by </span><span style="color: #BB0000;">country</span><span style="color: #0000BB;">:</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">All NUTS codes can be identified and classified.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #BB0000;">Unique</span><span style="color: #0000BB;"> NUTS version classified.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">No missing NUTS codes.</span></span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Converting version of NUTS codes</span> <span style="color: #00BBBB;">──────────────────────────────────</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #0000BB;">Within </span><span style="color: #BB0000;">groups</span><span style="color: #0000BB;"> defined by </span><span style="color: #BB0000;">country</span><span style="color: #0000BB;">:</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> <span style="color: #0000BB;">Converting NUTS codes in 1 version </span><span style="color: #BB0000;">2016</span><span style="color: #0000BB;"> to version </span><span style="color: #BB0000;">2021</span><span style="color: #0000BB;">.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">All NUTS codes can be converted.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">Version is </span><span style="color: #BB0000;">unique</span><span style="color: #0000BB;">.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">No </span><span style="color: #BB0000;">missing</span><span style="color: #0000BB;"> NUTS codes.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">##   to_code to_version country values values_per_thous</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> NO02    2021       Norway    13.2           <span style="text-decoration: underline;">13</span>239 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> NO06    2021       Norway   143.           <span style="text-decoration: underline;">143</span>106.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> NO07    2021       Norway    16.5           <span style="text-decoration: underline;">16</span>463 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> NO08    2021       Norway    71.0           <span style="text-decoration: underline;">71</span>037.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> NO09    2021       Norway    83.0           <span style="text-decoration: underline;">82</span>964.</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> NO0A    2021       Norway    58.9           <span style="text-decoration: underline;">58</span>904.</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="converting-grouped-data">Converting grouped data<a class="anchor" aria-label="anchor" href="#converting-grouped-data"></a>
</h4>
<p>Longitudinal regional data, as commonly supplied by EUROSTAT, often comes with varying NUTS versions across countries and years (and other dimensions). It is possible to harmonize data across such <strong>groups</strong> with the <code>group_vars</code> argument in <code><a href="../reference/nuts_classify.html">nuts_classify()</a></code>. Below, we transform data within country and year groups for Sweden, Slovenia, and Croatia to the 2021 NUTS version.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Classifying grouped data (time)</span></span>
<span><span class="va">pat_n2_mhab_sesihr</span> <span class="op">&lt;-</span> <span class="va">pat_n2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">unit</span> <span class="op">==</span> <span class="st">"P_MHAB"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">geo</span>, <span class="st">"^SE|^SI|^HR"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pat_classified</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nuts_classify.html">nuts_classify</a></span><span class="op">(</span>nuts_code <span class="op">=</span> <span class="st">"geo"</span>, data <span class="op">=</span> <span class="va">pat_n2_mhab_sesihr</span>,</span>
<span>    group_vars <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Classifying version of NUTS codes</span> <span style="color: #00BBBB;">─────────────────────────────────</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #0000BB;">Within </span><span style="color: #BB0000;">groups</span><span style="color: #0000BB;"> defined by </span><span style="color: #BB0000;">country</span><span style="color: #0000BB;"> and </span><span style="color: #BB0000;">time</span><span style="color: #0000BB;">:</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">All NUTS codes can be identified and classified.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #BB0000;">Unique</span><span style="color: #0000BB;"> NUTS version classified.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">No missing NUTS codes.</span></span></span></code></pre>
<p>Note that the detected best-fitting NUTS versions differ across countries:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nuts_get_data.html">nuts_get_data</a></span><span class="op">(</span><span class="va">pat_classified</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">from_version</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">tally</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 3 × 3</span></span></span>
<span><span class="co">## <span style="color: #949494;"># Groups:   country [3]</span></span></span>
<span><span class="co">##   country  from_version     n</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Croatia  2016            24</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> Slovenia 2010            26</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> Sweden   2021           104</span></span></code></pre>
<p>The grouping is stored and passed on to the conversion function:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Converting grouped data (Time)</span></span>
<span><span class="va">pat_converted</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nuts_convert_version.html">nuts_convert_version</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">pat_classified</span>,</span>
<span>  to_version <span class="op">=</span> <span class="st">"2021"</span>,</span>
<span>  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"values"</span> <span class="op">=</span> <span class="st">"relative"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Converting version of NUTS codes</span> <span style="color: #00BBBB;">──────────────────────────────────</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #0000BB;">Within </span><span style="color: #BB0000;">groups</span><span style="color: #0000BB;"> defined by </span><span style="color: #BB0000;">country</span><span style="color: #0000BB;"> and </span><span style="color: #BB0000;">time</span><span style="color: #0000BB;">:</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> <span style="color: #0000BB;">Converting NUTS codes in 3 versions </span><span style="color: #BB0000;">2016</span><span style="color: #0000BB;">, </span><span style="color: #BB0000;">2021</span><span style="color: #0000BB;">, and </span><span style="color: #BB0000;">2010</span><span style="color: #0000BB;"> to version</span></span></span>
<span><span class="co">##   <span style="color: #BB0000;">2021</span><span style="color: #0000BB;">.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">All NUTS codes can be converted.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">Version is </span><span style="color: #BB0000;">unique</span><span style="color: #0000BB;">.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">No </span><span style="color: #BB0000;">missing</span><span style="color: #0000BB;"> NUTS codes.</span></span></span></code></pre>
<p>Conveniently, the group argument can also be used to transform higher dimensional data. Below, we include two indicators for patent applications to convert data that varies at the indicator-year-country-NUTS code level.</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Classifying and converting multi-group data</span></span>
<span><span class="va">pat_n2_mhabmact_12_sesihr</span> <span class="op">&lt;-</span> <span class="va">pat_n2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">unit</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P_MHAB"</span>, <span class="st">"P_MACT"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">geo</span>, <span class="st">"^SE|^SI|^HR"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pat_converted</span> <span class="op">&lt;-</span> <span class="va">pat_n2_mhabmact_12_sesihr</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/nuts_classify.html">nuts_classify</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">.</span>,</span>
<span>    nuts_code <span class="op">=</span> <span class="st">"geo"</span>,</span>
<span>    group_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"unit"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/nuts_convert_version.html">nuts_convert_version</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">.</span>,</span>
<span>    to_version <span class="op">=</span> <span class="st">"2021"</span>,</span>
<span>    variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"values"</span> <span class="op">=</span> <span class="st">"relative"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Classifying version of NUTS codes</span> <span style="color: #00BBBB;">─────────────────────────────────</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #0000BB;">Within </span><span style="color: #BB0000;">groups</span><span style="color: #0000BB;"> defined by </span><span style="color: #BB0000;">country</span><span style="color: #0000BB;">, </span><span style="color: #BB0000;">time</span><span style="color: #0000BB;">, and </span><span style="color: #BB0000;">unit</span><span style="color: #0000BB;">:</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">All NUTS codes can be identified and classified.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #BB0000;">Unique</span><span style="color: #0000BB;"> NUTS version classified.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">No missing NUTS codes.</span></span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Converting version of NUTS codes</span> <span style="color: #00BBBB;">──────────────────────────────────</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #0000BB;">Within </span><span style="color: #BB0000;">groups</span><span style="color: #0000BB;"> defined by </span><span style="color: #BB0000;">country</span><span style="color: #0000BB;">, </span><span style="color: #BB0000;">time</span><span style="color: #0000BB;">, and </span><span style="color: #BB0000;">unit</span><span style="color: #0000BB;">:</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> <span style="color: #0000BB;">Converting NUTS codes in 3 versions </span><span style="color: #BB0000;">2016</span><span style="color: #0000BB;">, </span><span style="color: #BB0000;">2021</span><span style="color: #0000BB;">, and </span><span style="color: #BB0000;">2010</span><span style="color: #0000BB;"> to version</span></span></span>
<span><span class="co">##   <span style="color: #BB0000;">2021</span><span style="color: #0000BB;">.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">All NUTS codes can be converted.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">Version is </span><span style="color: #BB0000;">unique</span><span style="color: #0000BB;">.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">No </span><span style="color: #BB0000;">missing</span><span style="color: #0000BB;"> NUTS codes.</span></span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="converting-data-between-nuts-levels">Converting data between NUTS levels<a class="anchor" aria-label="anchor" href="#converting-data-between-nuts-levels"></a>
</h3>
<p>The <code><a href="../reference/nuts_aggregate.html">nuts_aggregate()</a></code> function facilitates the <strong>aggregation</strong> of data from lower NUTS <strong>levels</strong> to higher ones using spatial weights. This enables users to summarize variables upward from the NUTS-3 level to NUTS-2 or NUTS-1 levels. It is important to note that this function does not support disaggregation since this comes with strong assumptions about the spatial distribution of a variable’s values.</p>
<p>In the following example, we illustrate how to aggregate the total number of patent applications in Sweden from NUTS-3 to higher levels. The functions below return a warning concerning non-identifiable NUTS codes. See <a href="#nuts_not_identified"><em>Non-identified NUTS codes</em></a> for further information.</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"patents"</span>, package <span class="op">=</span> <span class="st">"nuts"</span><span class="op">)</span></span>
<span><span class="co"># Aggregating data from NUTS-3 to NUTS-2 and NUTS-1</span></span>
<span><span class="va">pat_n3</span> <span class="op">&lt;-</span> <span class="va">patents</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">geo</span><span class="op">)</span> <span class="op">==</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pat_n3_nr_12_se</span> <span class="op">&lt;-</span> <span class="va">pat_n3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">unit</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NR"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">time</span> <span class="op">==</span> <span class="fl">2012</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">geo</span>, <span class="st">"^SE"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pat_classified</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nuts_classify.html">nuts_classify</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">pat_n3_nr_12_se</span>,</span>
<span>  nuts_code <span class="op">=</span> <span class="st">"geo"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Classifying version of NUTS codes</span> <span style="color: #00BBBB;">─────────────────────────────────</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #0000BB;">Within </span><span style="color: #BB0000;">groups</span><span style="color: #0000BB;"> defined by </span><span style="color: #BB0000;">country</span><span style="color: #0000BB;">:</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #BBBB00;">!</span> <span style="color: #0000BB;">These NUTS codes cannot be identified or classified: </span><span style="color: #BB0000;">SEXXX</span><span style="color: #0000BB;"> and</span></span></span>
<span><span class="co">##   <span style="color: #BB0000;">SEZZZ</span><span style="color: #0000BB;">.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #BB0000;">Unique</span><span style="color: #0000BB;"> NUTS version classified.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">No missing NUTS codes.</span></span></span></code></pre>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pat_level2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nuts_aggregate.html">nuts_aggregate</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">pat_classified</span>,</span>
<span>  to_level <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"values"</span> <span class="op">=</span> <span class="st">"absolute"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Converting version of NUTS codes</span> <span style="color: #00BBBB;">──────────────────────────────────</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #0000BB;">Within </span><span style="color: #BB0000;">groups</span><span style="color: #0000BB;"> defined by </span><span style="color: #BB0000;">country</span><span style="color: #0000BB;">:</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> <span style="color: #0000BB;">Aggregate from NUTS regional level </span><span style="color: #BB0000;">3</span><span style="color: #0000BB;"> to </span><span style="color: #BB0000;">2</span>.</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">These NUTS codes cannot be converted and </span><span style="color: #BB0000;">are dropped</span><span style="color: #0000BB;">: </span><span style="color: #BB0000;">SEXXX</span><span style="color: #0000BB;"> and</span></span></span>
<span><span class="co">##   <span style="color: #BB0000;">SEZZZ</span><span style="color: #0000BB;">.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">Version is </span><span style="color: #BB0000;">unique</span><span style="color: #0000BB;">.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">No </span><span style="color: #BB0000;">missing</span><span style="color: #0000BB;"> NUTS codes.</span></span></span></code></pre>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pat_level1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nuts_aggregate.html">nuts_aggregate</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">pat_classified</span>,</span>
<span>  to_level <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"values"</span> <span class="op">=</span> <span class="st">"absolute"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Converting version of NUTS codes</span> <span style="color: #00BBBB;">──────────────────────────────────</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #0000BB;">Within </span><span style="color: #BB0000;">groups</span><span style="color: #0000BB;"> defined by </span><span style="color: #BB0000;">country</span><span style="color: #0000BB;">:</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> <span style="color: #0000BB;">Aggregate from NUTS regional level </span><span style="color: #BB0000;">3</span><span style="color: #0000BB;"> to </span><span style="color: #BB0000;">1</span>.</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">These NUTS codes cannot be converted and </span><span style="color: #BB0000;">are dropped</span><span style="color: #0000BB;">: </span><span style="color: #BB0000;">SEXXX</span><span style="color: #0000BB;"> and</span></span></span>
<span><span class="co">##   <span style="color: #BB0000;">SEZZZ</span><span style="color: #0000BB;">.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">Version is </span><span style="color: #BB0000;">unique</span><span style="color: #0000BB;">.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">No </span><span style="color: #BB0000;">missing</span><span style="color: #0000BB;"> NUTS codes.</span></span></span></code></pre>
<div class="figure">
<img src="nuts_files/figure-html/unnamed-chunk-23-1.png" alt="Three maps of Sweden with patent applications at the NUTS 3 level and aggregated to NUTS level 2 and 1." width="100%"><p class="caption">
Aggregating patents from NUTS 3 to NUTS 2 and NUTS 1; Sources: <a href="https://ec.europa.eu/eurostat/web/gisco/geodata/reference-data/administrative-units-statistical-units/nuts" class="external-link">Shapefiles</a> and <a href="https://ec.europa.eu/eurostat/databrowser/view/PAT_EP_RTOT/default/table?lang=en" class="external-link">data</a> are from EUROSTAT; Created using the <a href="https://r-spatial.github.io/sf/" class="external-link">sf</a> package.
</p>
</div>
</div>
<div class="section level3">
<h3 id="inconsistent-versions-and-levels">Inconsistent versions and levels<a class="anchor" aria-label="anchor" href="#inconsistent-versions-and-levels"></a>
</h3>
<div class="section level4">
<h4 id="nuts_not_identified">Non-identified NUTS codes<a class="anchor" aria-label="anchor" href="#nuts_not_identified"></a>
</h4>
<p>If the input data contains NUTS codes that cannot be identified in any NUTS version, the output of <code>classify_nuts</code> lists all of these codes. All conversion procedures (<code><a href="../reference/nuts_convert_version.html">nuts_convert_version()</a></code> and <code><a href="../reference/nuts_aggregate.html">nuts_aggregate()</a></code>) will work as expected while ignoring values for these regions.</p>
<p>The example below classifies 2012 patent data from Denmark. The original EUROSTAT data contains the codes <code>DKZZZ</code> and <code>DKXXX</code>, which are not part of the conversion matrices. Codes ending with the letter Z refer to “<a href="https://stat.gov.pl/en/regional-statistics/classification-of-territorial-units/classification-of-territorial-units-for-statistics-nuts/principles-for-creation-and-development-of-nuts-units/" class="external-link">Extra-Regio</a>” territories. These codes collect statistics for territories that cannot be attached to a certain region.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Such as air-space, territorial waters and the continental shelf, embassies, consulates, military bases and deposits of oil, natural gas, etc. in international waters.&lt;/p&gt;"><sup>3</sup></a> Codes ending with the letter X refer to observations with unknown regions.</p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pat_n3.nr.12.dk</span> <span class="op">&lt;-</span> <span class="va">pat_n3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">unit</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NR"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">time</span> <span class="op">==</span> <span class="fl">2012</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">geo</span>, <span class="st">"^DK"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pat_classified</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nuts_classify.html">nuts_classify</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">pat_n3.nr.12.dk</span>, </span>
<span>  nuts_code <span class="op">=</span> <span class="st">"geo"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Classifying version of NUTS codes</span> <span style="color: #00BBBB;">─────────────────────────────────</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #0000BB;">Within </span><span style="color: #BB0000;">groups</span><span style="color: #0000BB;"> defined by </span><span style="color: #BB0000;">country</span><span style="color: #0000BB;">:</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #BBBB00;">!</span> <span style="color: #0000BB;">These NUTS codes cannot be identified or classified: </span><span style="color: #BB0000;">DKXXX</span><span style="color: #0000BB;"> and</span></span></span>
<span><span class="co">##   <span style="color: #BB0000;">DKZZZ</span><span style="color: #0000BB;">.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #BB0000;">Unique</span><span style="color: #0000BB;"> NUTS version classified.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">No missing NUTS codes.</span></span></span></code></pre>
</div>
<div class="section level4">
<h4 id="missing-nuts-codes">Missing NUTS codes<a class="anchor" aria-label="anchor" href="#missing-nuts-codes"></a>
</h4>
<p><code><a href="../reference/nuts_classify.html">nuts_classify()</a></code> also checks whether the NUTS codes provided are complete (or values of a variable that the user wants to convert are missing for a region). Missing values in the input data will, by default, result in missing values for all affected transformed regions in the output data.</p>
<p>The example with Slovenia below illustrates this case.</p>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pat_n3_nr_12_si</span> <span class="op">&lt;-</span> <span class="va">pat_n3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">unit</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NR"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">time</span> <span class="op">==</span> <span class="fl">2012</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">geo</span>, <span class="st">"^SI"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pat_classified</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nuts_classify.html">nuts_classify</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">pat_n3_nr_12_si</span>, </span>
<span>  nuts_code <span class="op">=</span> <span class="st">"geo"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Classifying version of NUTS codes</span> <span style="color: #00BBBB;">─────────────────────────────────</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #0000BB;">Within </span><span style="color: #BB0000;">groups</span><span style="color: #0000BB;"> defined by </span><span style="color: #BB0000;">country</span><span style="color: #0000BB;">:</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #BBBB00;">!</span> <span style="color: #0000BB;">These NUTS codes cannot be identified or classified: </span><span style="color: #BB0000;">SIXXX</span><span style="color: #0000BB;"> and</span></span></span>
<span><span class="co">##   <span style="color: #BB0000;">SIZZZ</span><span style="color: #0000BB;">.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #BB0000;">Unique</span><span style="color: #0000BB;"> NUTS version classified.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #BB0000;">Missing</span><span style="color: #0000BB;"> NUTS codes detected. See the tibble 'missing_data' in the</span></span></span>
<span><span class="co">##   <span style="color: #0000BB;">output.</span></span></span></code></pre>
<p><code><a href="../reference/nuts_classify.html">nuts_classify()</a></code> returns a warning that NUTS codes are missing in the input data. These codes can be inspected by calling <code>nuts_get_missing(pat_classified)</code>.</p>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nuts_get_missing.html">nuts_get_missing</a></span><span class="op">(</span><span class="va">pat_classified</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 4</span></span></span>
<span><span class="co">##   from_code from_version from_level country </span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> SI011     2010                  3 Slovenia</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> SI016     2010                  3 Slovenia</span></span></code></pre>
<p>The resulting conversion returns three missing values as the source code <code>SI011</code> transformed into <code>SI031</code> and the region <code>SI016</code> was split into <code>SI036</code> and <code>SI037</code>.</p>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nuts_convert_version.html">nuts_convert_version</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">pat_classified</span>, </span>
<span>  to_version <span class="op">=</span> <span class="st">"2021"</span>, </span>
<span>  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"values"</span> <span class="op">=</span> <span class="st">"absolute"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Converting version of NUTS codes</span> <span style="color: #00BBBB;">──────────────────────────────────</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #0000BB;">Within </span><span style="color: #BB0000;">groups</span><span style="color: #0000BB;"> defined by </span><span style="color: #BB0000;">country</span><span style="color: #0000BB;">:</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> <span style="color: #0000BB;">Converting NUTS codes in 1 version </span><span style="color: #BB0000;">2010</span><span style="color: #0000BB;"> to version </span><span style="color: #BB0000;">2021</span><span style="color: #0000BB;">.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">These NUTS codes cannot be converted and </span><span style="color: #BB0000;">are dropped</span><span style="color: #0000BB;">: </span><span style="color: #BB0000;">SIXXX</span><span style="color: #0000BB;"> and</span></span></span>
<span><span class="co">##   <span style="color: #BB0000;">SIZZZ</span><span style="color: #0000BB;">.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">Version is </span><span style="color: #BB0000;">unique</span><span style="color: #0000BB;">.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #BB0000;">Missing</span><span style="color: #0000BB;"> NUTS codes in data. No values are calculated for regions</span></span></span>
<span><span class="co">##   <span style="color: #0000BB;">associated with missing NUTS codes. Ensure that the input data is</span></span></span>
<span><span class="co">##   <span style="color: #0000BB;">complete.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 3 × 4</span></span></span>
<span><span class="co">##   to_code to_version country  values</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> SI031   2021       Slovenia     <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> SI036   2021       Slovenia     <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> SI037   2021       Slovenia     <span style="color: #BB0000;">NA</span></span></span></code></pre>
<p>Users have the option <code>missing_weights_pct</code> to investigate the consequences of missing values in the converted data. Setting the argument to <code>TRUE</code> returns a variable that indicates the percentage of missing weights due to missing NUTS codes (or missing values in the variable). The data frame below shows three regions that could not be computed due to missing data. Values in region <code>SI036</code> could not be computed since 97.9% of the weights are missing. Values for region <code>SI037</code> are missing as well even though only 0.8% of its population-weighted area is missing.</p>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nuts_convert_version.html">nuts_convert_version</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">pat_classified</span>, </span>
<span>  to_version <span class="op">=</span> <span class="st">"2021"</span>, </span>
<span>  weight <span class="op">=</span> <span class="st">"pop18"</span>,</span>
<span>  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"values"</span> <span class="op">=</span> <span class="st">"absolute"</span><span class="op">)</span>,</span>
<span>  missing_weights_pct <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">values_na_w</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Converting version of NUTS codes</span> <span style="color: #00BBBB;">──────────────────────────────────</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #0000BB;">Within </span><span style="color: #BB0000;">groups</span><span style="color: #0000BB;"> defined by </span><span style="color: #BB0000;">country</span><span style="color: #0000BB;">:</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> <span style="color: #0000BB;">Converting NUTS codes in 1 version </span><span style="color: #BB0000;">2010</span><span style="color: #0000BB;"> to version </span><span style="color: #BB0000;">2021</span><span style="color: #0000BB;">.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">These NUTS codes cannot be converted and </span><span style="color: #BB0000;">are dropped</span><span style="color: #0000BB;">: </span><span style="color: #BB0000;">SIXXX</span><span style="color: #0000BB;"> and</span></span></span>
<span><span class="co">##   <span style="color: #BB0000;">SIZZZ</span><span style="color: #0000BB;">.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">Version is </span><span style="color: #BB0000;">unique</span><span style="color: #0000BB;">.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #BB0000;">Missing</span><span style="color: #0000BB;"> NUTS codes in data. No values are calculated for regions</span></span></span>
<span><span class="co">##   <span style="color: #0000BB;">associated with missing NUTS codes. Ensure that the input data is</span></span></span>
<span><span class="co">##   <span style="color: #0000BB;">complete.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 12 × 5</span></span></span>
<span><span class="co">##    to_code to_version country  values values_na_w</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> SI031   2021       Slovenia  <span style="color: #BB0000;">NA</span>        100    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> SI036   2021       Slovenia  <span style="color: #BB0000;">NA</span>         97.9  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> SI037   2021       Slovenia  <span style="color: #BB0000;">NA</span>          0.802</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> SI032   2021       Slovenia   7.84       0    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> SI033   2021       Slovenia   3.22       0    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> SI034   2021       Slovenia  15.2        0    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> SI035   2021       Slovenia   6.99       0    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> SI038   2021       Slovenia   1.25       0    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> SI041   2021       Slovenia  42.1        0    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> SI042   2021       Slovenia   6.56       0    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span> SI043   2021       Slovenia   7.22       0    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">12</span> SI044   2021       Slovenia   3.3        0</span></span></code></pre>
<p>Using the the share of missing weights in combination with the option <code>missing_rm</code>, the <code>nuts</code> package allows to recover some of the missing regions approximately. We can achieve this by setting <code>missing_rm</code> to <code>TRUE</code>, effectively assuming 0 for missing values. In the next step we remove regions with a high share of missing weights from the output data again. The data frame below shows that values for <code>SI037</code> could still be used assuming 0 patents for 0.8% of the missing population-weighted area to construct the region.</p>
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nuts_convert_version.html">nuts_convert_version</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">pat_classified</span>, </span>
<span>  to_version <span class="op">=</span> <span class="st">"2021"</span>, </span>
<span>  weight <span class="op">=</span> <span class="st">"pop18"</span>,</span>
<span>  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"values"</span> <span class="op">=</span> <span class="st">"absolute"</span><span class="op">)</span>,</span>
<span>  missing_weights_pct <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  missing_rm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">to_code</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SI031"</span>, <span class="st">"SI036"</span>, <span class="st">"SI037"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>values_imp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">values_na_w</span> <span class="op">&lt;</span> <span class="fl">1</span>, <span class="va">values</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Converting version of NUTS codes</span> <span style="color: #00BBBB;">──────────────────────────────────</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #0000BB;">Within </span><span style="color: #BB0000;">groups</span><span style="color: #0000BB;"> defined by </span><span style="color: #BB0000;">country</span><span style="color: #0000BB;">:</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> <span style="color: #0000BB;">Converting NUTS codes in 1 version </span><span style="color: #BB0000;">2010</span><span style="color: #0000BB;"> to version </span><span style="color: #BB0000;">2021</span><span style="color: #0000BB;">.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">These NUTS codes cannot be converted and </span><span style="color: #BB0000;">are dropped</span><span style="color: #0000BB;">: </span><span style="color: #BB0000;">SIXXX</span><span style="color: #0000BB;"> and</span></span></span>
<span><span class="co">##   <span style="color: #BB0000;">SIZZZ</span><span style="color: #0000BB;">.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">Version is </span><span style="color: #BB0000;">unique</span><span style="color: #0000BB;">.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #BB0000;">Missing</span><span style="color: #0000BB;"> NUTS codes in data. No values are calculated for regions</span></span></span>
<span><span class="co">##   <span style="color: #0000BB;">associated with missing NUTS codes. Ensure that the input data is</span></span></span>
<span><span class="co">##   <span style="color: #0000BB;">complete.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 3 × 6</span></span></span>
<span><span class="co">##   to_code to_version country  values values_na_w values_imp</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> SI031   2021       Slovenia  0         100          <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> SI036   2021       Slovenia  0.331      97.9        <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> SI037   2021       Slovenia  4.02        0.802       4.02</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="multiple-nuts-levels-within-groups">Multiple NUTS levels within groups<a class="anchor" aria-label="anchor" href="#multiple-nuts-levels-within-groups"></a>
</h4>
<p>The package does not allow for the conversion of <strong>multiple NUTS levels</strong> at once. The classification function will throw an error in this case. The conversion needs to be conducted for every level separately.</p>
<div class="sourceCode" id="cb138"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">patents</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">geo</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^EL"</span>, <span class="va">geo</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">geo</span>, .keep_all <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/nuts_classify.html">nuts_classify</a></span><span class="op">(</span>nuts_code <span class="op">=</span> <span class="st">"geo"</span>, data <span class="op">=</span> <span class="va">.</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;"> in `nuts_classify()`:</span></span></span>
<span><span class="co">## <span style="color: #BBBB00;">!</span> Data contains NUTS codes from multiple levels (2 and 3).</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="multiple-nuts-versions-within-groups">Multiple NUTS versions within groups<a class="anchor" aria-label="anchor" href="#multiple-nuts-versions-within-groups"></a>
</h4>
<p>Converting <strong>multiple NUTS versions</strong> within groups might lead to erroneous spatial interpolations since overlaps between regions of different versions are possible.</p>
<p>The example below illustrates this problem. We classify German and Italian manure storage facility data from EUROSTAT without specifying <code>group_vars</code>. Instead, we keep all unique NUTS codes to artificially create a data set containing different NUTS versions. <code><a href="../reference/nuts_classify.html">nuts_classify()</a></code> returns a warning and by inspecting the identified versions, we see that there are mixed versions within groups (the countries).</p>
<div class="sourceCode" id="cb140"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">man_deit</span> <span class="op">&lt;-</span> <span class="va">manure</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^DE|^IT"</span>, <span class="va">geo</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">geo</span><span class="op">)</span> <span class="op">==</span> <span class="fl">4</span>, <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">geo</span>, .keep_all <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/nuts_classify.html">nuts_classify</a></span><span class="op">(</span>nuts_code <span class="op">=</span> <span class="st">"geo"</span>, data <span class="op">=</span> <span class="va">.</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Classifying version of NUTS codes</span> <span style="color: #00BBBB;">─────────────────────────────────</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #0000BB;">Within </span><span style="color: #BB0000;">groups</span><span style="color: #0000BB;"> defined by </span><span style="color: #BB0000;">country</span><span style="color: #0000BB;">:</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #BBBB00;">!</span> <span style="color: #0000BB;">These NUTS codes cannot be identified or classified: </span><span style="color: #BB0000;">DEZZ</span><span style="color: #0000BB;">.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #BB0000;">Multiple</span><span style="color: #0000BB;"> NUTS versions classified. See the tibble 'versions_data'</span></span></span>
<span><span class="co">##   <span style="color: #0000BB;">in the output.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #BB0000;">Missing</span><span style="color: #0000BB;"> NUTS codes detected. See the tibble 'missing_data' in the</span></span></span>
<span><span class="co">##   <span style="color: #0000BB;">output.</span></span></span></code></pre>
<div class="sourceCode" id="cb147"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nuts_get_data.html">nuts_get_data</a></span><span class="op">(</span><span class="va">man_deit</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">from_version</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">tally</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 5 × 3</span></span></span>
<span><span class="co">## <span style="color: #949494;"># Groups:   country [3]</span></span></span>
<span><span class="co">##   country from_version     n</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Germany 2006            38</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> Germany 2021             3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> Italy   2006             9</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> Italy   2021            21</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>               1</span></span></code></pre>
<p>When proceeding to the conversion with either <code><a href="../reference/nuts_convert_version.html">nuts_convert_version()</a></code> or <code><a href="../reference/nuts_aggregate.html">nuts_aggregate()</a></code>, both functions will throw an error. For convenience, we added the option <code>multiple_versions</code> that subsets the supplied data to the dominant version within groups when specified with <code>most_frequent</code>. Hence, all codes from other, non-dominant versions are discarded.</p>
<p>Once we convert this data set, all NUTS regions unrecognized according to the 2006 (Germany) and 2021 (Italy) version are dropped automatically.</p>
<div class="sourceCode" id="cb149"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">man_deit_converted</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nuts_convert_version.html">nuts_convert_version</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">man_deit</span>,</span>
<span>  to_version <span class="op">=</span> <span class="fl">2021</span>,</span>
<span>  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"values"</span> <span class="op">=</span> <span class="st">"relative"</span><span class="op">)</span>,</span>
<span>  multiple_versions <span class="op">=</span> <span class="st">"most_frequent"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Converting version of NUTS codes</span> <span style="color: #00BBBB;">──────────────────────────────────</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #0000BB;">Within </span><span style="color: #BB0000;">groups</span><span style="color: #0000BB;"> defined by </span><span style="color: #BB0000;">country</span><span style="color: #0000BB;">:</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> <span style="color: #0000BB;">Converting NUTS codes in 2 versions </span><span style="color: #BB0000;">2006</span><span style="color: #0000BB;"> and </span><span style="color: #BB0000;">2021</span><span style="color: #0000BB;"> to version </span><span style="color: #BB0000;">2021</span><span style="color: #0000BB;">.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">These NUTS codes cannot be converted and </span><span style="color: #BB0000;">are dropped</span><span style="color: #0000BB;">: </span><span style="color: #BB0000;">DEZZ</span><span style="color: #0000BB;">.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #BBBB00;">!</span> <span style="color: #0000BB;">Choosing most frequent version within group and </span><span style="color: #BB0000;">dropping</span><span style="color: #0000BB;"> 12 rows.</span></span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #BB0000;">Missing</span><span style="color: #0000BB;"> NUTS codes in data. No values are calculated for regions</span></span></span>
<span><span class="co">##   <span style="color: #0000BB;">associated with missing NUTS codes. Ensure that the input data is</span></span></span>
<span><span class="co">##   <span style="color: #0000BB;">complete.</span></span></span></code></pre>
<div class="sourceCode" id="cb157"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">man_deit_converted</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">to_version</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">tally</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">## <span style="color: #949494;"># Groups:   country [2]</span></span></span>
<span><span class="co">##   country to_version     n</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Germany       <span style="text-decoration: underline;">2</span>021    38</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> Italy         <span style="text-decoration: underline;">2</span>021    21</span></span></code></pre>
</div>
</div>
</div>
<div class="section level2">
<h2 id="method">Spatial interpolation in detail<a class="anchor" aria-label="anchor" href="#method"></a>
</h2>
<p>This section describes the spatial interpolation procedure. We first cover the logic of conversion tables and then explain the methods used in the package for converting versions and levels.</p>
<div class="section level3">
<h3 id="changes-in-administrative-boundaries">Changes in administrative boundaries<a class="anchor" aria-label="anchor" href="#changes-in-administrative-boundaries"></a>
</h3>
<p>Below, Norwegian NUTS-2 regions for the versions 2016 and 2021 are shown. All regions apart from Norway’s most Northern region have been reorganized in this period.</p>
<div class="figure">
<img src="nuts_files/figure-html/unnamed-chunk-33-1.png" alt="Two maps of Norwegian NUTS-2 regions in version 2016 and 2021. The most Eastern and Southern regions have been affected most by administrative redistricting." width="100%"><p class="caption">
Norwegian NUTS-2 regions with boundary changes; Sources: <a href="https://ec.europa.eu/eurostat/web/gisco/geodata/reference-data/administrative-units-statistical-units/nuts" class="external-link">Shapefiles</a> from EUROSTAT; Created using the <a href="https://r-spatial.github.io/sf/" class="external-link">sf</a> package.
</p>
</div>
<p>The changes between the two versions can be summarized as follows:</p>
<ol style="list-style-type: decimal">
<li>Boundary changes of regions with <strong>continued</strong> NUTS codes</li>
</ol>
<ul>
<li>
<code>NO02</code> ceases a small area to the new <code>NO08</code>
</li>
<li>
<code>NO06</code> makes small area gains from <code>NO05</code>
</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Changes to regions with <strong>discontinued</strong> NUTS codes</li>
</ol>
<ul>
<li>
<code>NO01</code> is absorbed by <code>NO08</code>
</li>
<li>
<code>NO03</code> is split up between <code>NO08</code> and <code>NO09</code>
</li>
<li>
<code>NO04</code> divides into <code>NO0A</code> and <code>NO09</code>
</li>
<li>
<code>NO05</code> largely becomes the new <code>NO0A</code>, and gives a small area to <code>NO06</code>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="spatial-interpolation-and-conversion-tables">Spatial interpolation and conversion tables<a class="anchor" aria-label="anchor" href="#spatial-interpolation-and-conversion-tables"></a>
</h3>
<p>To keep track of these changes, the <code>nuts</code> package uses two data sets:</p>
<ol style="list-style-type: decimal">
<li>Stocks: data(<code>all_nuts_codes</code>) contains <strong>all historical NUTS codes</strong> by NUTS version and country</li>
<li>Flows: data(<code>cross_walks</code>) contains the <strong>conversion tables</strong> between NUTS versions</li>
</ol>
<p>They are based on <a href="https://urban.jrc.ec.europa.eu/nutsconverter/#/" class="external-link">data provided by the JRC</a>. Both data sets can also be used by the user manually to explore specific conversion patterns more closely.</p>
<p>For Norway going from version 2016 to 2021 at NUTS level 2, the <code>cross_walks</code> can be easily subset as follows:</p>
<div class="sourceCode" id="cb159"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">no_walks</span> <span class="op">&lt;-</span> <span class="va">cross_walks</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">from_code</span><span class="op">)</span> <span class="op">==</span> <span class="fl">4</span>,</span>
<span>         <span class="va">from_version</span> <span class="op">==</span> <span class="fl">2016</span>,</span>
<span>         <span class="va">to_version</span> <span class="op">==</span> <span class="fl">2021</span>,</span>
<span>         <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^NO"</span>, <span class="va">from_code</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Which results in the following conversion table:</p>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
from_code
</th>
<th style="text-align:left;">
to_code
</th>
<th style="text-align:left;">
from_version
</th>
<th style="text-align:left;">
to_version
</th>
<th style="text-align:right;">
level
</th>
<th style="text-align:left;">
country
</th>
<th style="text-align:right;">
areaKm
</th>
<th style="text-align:right;">
pop18
</th>
<th style="text-align:right;">
pop11
</th>
<th style="text-align:right;">
artif_surf18
</th>
<th style="text-align:right;">
artif_surf12
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO01
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO08
</td>
<td style="text-align:left;background-color: azure !important;">
2016
</td>
<td style="text-align:left;background-color: aquamarine !important;">
2021
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Norway
</td>
<td style="text-align:right;">
5365.0
</td>
<td style="text-align:right;">
1268387.7
</td>
<td style="text-align:right;">
1131221.0
</td>
<td style="text-align:right;">
58104
</td>
<td style="text-align:right;">
55927
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO02
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO02
</td>
<td style="text-align:left;background-color: azure !important;">
2016
</td>
<td style="text-align:left;background-color: aquamarine !important;">
2021
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Norway
</td>
<td style="text-align:right;">
52072.3
</td>
<td style="text-align:right;">
370392.3
</td>
<td style="text-align:right;">
362070.7
</td>
<td style="text-align:right;">
60625
</td>
<td style="text-align:right;">
54887
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO02
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO08
</td>
<td style="text-align:left;background-color: azure !important;">
2016
</td>
<td style="text-align:left;background-color: aquamarine !important;">
2021
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Norway
</td>
<td style="text-align:right;">
517.6
</td>
<td style="text-align:right;">
15843.5
</td>
<td style="text-align:right;">
15019.0
</td>
<td style="text-align:right;">
1952
</td>
<td style="text-align:right;">
1813
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO03
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO08
</td>
<td style="text-align:left;background-color: azure !important;">
2016
</td>
<td style="text-align:left;background-color: aquamarine !important;">
2021
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Norway
</td>
<td style="text-align:right;">
19123.5
</td>
<td style="text-align:right;">
575350.1
</td>
<td style="text-align:right;">
535560.5
</td>
<td style="text-align:right;">
66876
</td>
<td style="text-align:right;">
62509
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO03
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO09
</td>
<td style="text-align:left;background-color: azure !important;">
2016
</td>
<td style="text-align:left;background-color: aquamarine !important;">
2021
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Norway
</td>
<td style="text-align:right;">
17414.4
</td>
<td style="text-align:right;">
403640.4
</td>
<td style="text-align:right;">
385648.8
</td>
<td style="text-align:right;">
50076
</td>
<td style="text-align:right;">
47799
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO04
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO09
</td>
<td style="text-align:left;background-color: azure !important;">
2016
</td>
<td style="text-align:left;background-color: aquamarine !important;">
2021
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Norway
</td>
<td style="text-align:right;">
16360.8
</td>
<td style="text-align:right;">
292218.9
</td>
<td style="text-align:right;">
272016.3
</td>
<td style="text-align:right;">
44779
</td>
<td style="text-align:right;">
42346
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO04
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO0A
</td>
<td style="text-align:left;background-color: azure !important;">
2016
</td>
<td style="text-align:left;background-color: aquamarine !important;">
2021
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Norway
</td>
<td style="text-align:right;">
9326.0
</td>
<td style="text-align:right;">
451949.5
</td>
<td style="text-align:right;">
416975.4
</td>
<td style="text-align:right;">
39112
</td>
<td style="text-align:right;">
36432
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO05
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO06
</td>
<td style="text-align:left;background-color: azure !important;">
2016
</td>
<td style="text-align:left;background-color: aquamarine !important;">
2021
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Norway
</td>
<td style="text-align:right;">
931.8
</td>
<td style="text-align:right;">
3510.2
</td>
<td style="text-align:right;">
3625.9
</td>
<td style="text-align:right;">
869
</td>
<td style="text-align:right;">
832
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO05
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO0A
</td>
<td style="text-align:left;background-color: azure !important;">
2016
</td>
<td style="text-align:left;background-color: aquamarine !important;">
2021
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Norway
</td>
<td style="text-align:right;">
47902.2
</td>
<td style="text-align:right;">
837246.8
</td>
<td style="text-align:right;">
790090.1
</td>
<td style="text-align:right;">
99951
</td>
<td style="text-align:right;">
94757
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO06
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO06
</td>
<td style="text-align:left;background-color: azure !important;">
2016
</td>
<td style="text-align:left;background-color: aquamarine !important;">
2021
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Norway
</td>
<td style="text-align:right;">
41029.0
</td>
<td style="text-align:right;">
447774.0
</td>
<td style="text-align:right;">
417827.7
</td>
<td style="text-align:right;">
47291
</td>
<td style="text-align:right;">
43630
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO07
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO07
</td>
<td style="text-align:left;background-color: azure !important;">
2016
</td>
<td style="text-align:left;background-color: aquamarine !important;">
2021
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Norway
</td>
<td style="text-align:right;">
112453.1
</td>
<td style="text-align:right;">
452720.0
</td>
<td style="text-align:right;">
437265.2
</td>
<td style="text-align:right;">
81907
</td>
<td style="text-align:right;">
79098
</td>
</tr>
</tbody>
</table>
</div>
<p>In addition to tracing the evolution of NUTS codes, the table contains <strong>flows</strong> of area, population and artificial surfaces between regions and versions. These flows were computed by the JRC with granular [100m x 100m] geographic data. The <code>ggalluvial</code> plot below visualizes the flows of area size between the NUTS-2 regions mapped above.</p>
<div class="figure">
<img src="nuts_files/figure-html/unnamed-chunk-36-1.png" alt="The alluvial plot shows population flows from NUTS version 2016 to 2021." width="100%"><p class="caption">
Alluvial plot illustrating area size flows; Created using the <a href="https://corybrunson.github.io/ggalluvial/" class="external-link">ggalluvial</a> package.
</p>
</div>
<p>To illustrate the main idea, the map below showcases <strong>population densities</strong> across NUTS-2 regions. As population is not uniformly distributed across space, weighting regions dependent on their area size comes with strong assumptions. For instance, region <code>NO01</code> in version 2016, that contains the city of Oslo, makes a relatively modest geographical contribution to the new region <code>NO08</code>, but significantly bolsters the population of the latter. Assuming that the variable to be converted is correlated with population across space, the conversion can thus be refined using population weights to account for flows between different versions.</p>
<div class="figure">
<img src="nuts_files/figure-html/unnamed-chunk-37-1.png" alt="Two maps of Southern Norway with very granular population density and administrative boundaries of the 2016 and 2021 NUTS version. The region with the capital Olso and its adjacent region are highlighted in version 2016 that both contribute to a larger single region in version 2021." width="100%"><p class="caption">
Spatial distribution of population and boundary changes; Sources: <a href="https://ec.europa.eu/eurostat/web/gisco/geodata/reference-data/administrative-units-statistical-units/nuts" class="external-link">Shapefiles</a> and <a href="https://ec.europa.eu/eurostat/web/gisco/geodata/reference-data/population-distribution-demography/geostat" class="external-link">population raster</a> from EUROSTAT; Created using the <a href="https://r-spatial.github.io/sf/" class="external-link">sf</a> and the <a href="https://rspatial.github.io/terra/reference/terra-package.html" class="external-link">terra</a> packages.
</p>
</div>
</div>
<div class="section level3">
<h3 id="conversion-methods">Conversion methods<a class="anchor" aria-label="anchor" href="#conversion-methods"></a>
</h3>
<p>The following subsections describe the method used to convert absolute and relative values between versions and levels.</p>
<div class="section level4">
<h4 id="conversion-of-absolute-values-between-versions">Conversion of absolute values between versions<a class="anchor" aria-label="anchor" href="#conversion-of-absolute-values-between-versions"></a>
</h4>
<p>In this example, we transform <strong>absolute</strong> values, the number of patent applications (<code>NR</code>) in Norway, from <strong>version</strong> 2016 to 2021, utilizing spatial interpolation based on the population distribution in 2018.</p>
<p>The conversion employs the <code>cross_walks</code> table, which includes population flow data (expressed in thousands) between two NUTS-2 regions from the source version to the target version. The function joins the variable of interest, <code>NR</code>, which varies across the departing NUTS-2 codes (<code>from_code</code>). The function initially calculates a <strong>weight</strong> (<code>w</code>) equal to the population flow’s share of the total population in the departing region in version 2016 (<code>from_code</code>):</p>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
from_code
</th>
<th style="text-align:left;">
to_code
</th>
<th style="text-align:left;">
from_version
</th>
<th style="text-align:left;">
to_version
</th>
<th style="text-align:right;">
NR
</th>
<th style="text-align:right;">
pop18
</th>
<th style="text-align:left;">
w
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO01
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO08
</td>
<td style="text-align:left;background-color: azure !important;">
2016
</td>
<td style="text-align:left;background-color: aquamarine !important;">
2021
</td>
<td style="text-align:right;">
146
</td>
<td style="text-align:right;">
1268
</td>
<td style="text-align:left;background-color: rgba(255, 187, 255, 255) !important;">
1268/(1268) = 1
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO02
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO02
</td>
<td style="text-align:left;background-color: azure !important;">
2016
</td>
<td style="text-align:left;background-color: aquamarine !important;">
2021
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
370
</td>
<td style="text-align:left;background-color: rgba(255, 187, 255, 255) !important;">
370/(370 + 15) = 0.96
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO02
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO08
</td>
<td style="text-align:left;background-color: azure !important;">
2016
</td>
<td style="text-align:left;background-color: aquamarine !important;">
2021
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;background-color: rgba(255, 187, 255, 255) !important;">
15/(370 + 15) = 0.04
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO03
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO08
</td>
<td style="text-align:left;background-color: azure !important;">
2016
</td>
<td style="text-align:left;background-color: aquamarine !important;">
2021
</td>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
575
</td>
<td style="text-align:left;background-color: rgba(255, 187, 255, 255) !important;">
575/(575 + 403) = 0.59
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO03
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO09
</td>
<td style="text-align:left;background-color: azure !important;">
2016
</td>
<td style="text-align:left;background-color: aquamarine !important;">
2021
</td>
<td style="text-align:right;">
54
</td>
<td style="text-align:right;">
403
</td>
<td style="text-align:left;background-color: rgba(255, 187, 255, 255) !important;">
403/(575 + 403) = 0.41
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO04
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO09
</td>
<td style="text-align:left;background-color: azure !important;">
2016
</td>
<td style="text-align:left;background-color: aquamarine !important;">
2021
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
292
</td>
<td style="text-align:left;background-color: rgba(255, 187, 255, 255) !important;">
292/(292 + 451) = 0.39
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO04
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO0A
</td>
<td style="text-align:left;background-color: azure !important;">
2016
</td>
<td style="text-align:left;background-color: aquamarine !important;">
2021
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
451
</td>
<td style="text-align:left;background-color: rgba(255, 187, 255, 255) !important;">
451/(292 + 451) = 0.61
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO05
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO06
</td>
<td style="text-align:left;background-color: azure !important;">
2016
</td>
<td style="text-align:left;background-color: aquamarine !important;">
2021
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;background-color: rgba(255, 187, 255, 255) !important;">
3/(3 + 837) = 0
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO05
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO0A
</td>
<td style="text-align:left;background-color: azure !important;">
2016
</td>
<td style="text-align:left;background-color: aquamarine !important;">
2021
</td>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
837
</td>
<td style="text-align:left;background-color: rgba(255, 187, 255, 255) !important;">
837/(3 + 837) = 1
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO06
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO06
</td>
<td style="text-align:left;background-color: azure !important;">
2016
</td>
<td style="text-align:left;background-color: aquamarine !important;">
2021
</td>
<td style="text-align:right;">
62
</td>
<td style="text-align:right;">
447
</td>
<td style="text-align:left;background-color: rgba(255, 187, 255, 255) !important;">
447/(447) = 1
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO07
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO07
</td>
<td style="text-align:left;background-color: azure !important;">
2016
</td>
<td style="text-align:left;background-color: aquamarine !important;">
2021
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
452
</td>
<td style="text-align:left;background-color: rgba(255, 187, 255, 255) !important;">
452/(452) = 1
</td>
</tr>
</tbody>
</table>
</div>
<p>To obtain the number of patent applications at the desired 2021 version, the function summarizes the data for the new NUTS regions in version 2021 (<code>to_code</code>) by taking the <strong>population-weighted sum</strong> of all flows.</p>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
to_code
</th>
<th style="text-align:left;">
to_version
</th>
<th style="text-align:left;">
NR
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;background-color: aquamarine !important;">
NO02
</td>
<td style="text-align:left;background-color: aquamarine !important;">
2021
</td>
<td style="text-align:left;background-color: rgba(255, 240, 245, 255) !important;">
5 x 0.96 = 4.8
</td>
</tr>
<tr>
<td style="text-align:left;background-color: aquamarine !important;">
NO06
</td>
<td style="text-align:left;background-color: aquamarine !important;">
2021
</td>
<td style="text-align:left;background-color: rgba(255, 240, 245, 255) !important;">
41 x 0 + 62 x 1 = 62
</td>
</tr>
<tr>
<td style="text-align:left;background-color: aquamarine !important;">
NO07
</td>
<td style="text-align:left;background-color: aquamarine !important;">
2021
</td>
<td style="text-align:left;background-color: rgba(255, 240, 245, 255) !important;">
7 x 1 = 7
</td>
</tr>
<tr>
<td style="text-align:left;background-color: aquamarine !important;">
NO08
</td>
<td style="text-align:left;background-color: aquamarine !important;">
2021
</td>
<td style="text-align:left;background-color: rgba(255, 240, 245, 255) !important;">
146 x 1 + 5 x 0.04 + 54 x 0.59 = 178.06
</td>
</tr>
<tr>
<td style="text-align:left;background-color: aquamarine !important;">
NO09
</td>
<td style="text-align:left;background-color: aquamarine !important;">
2021
</td>
<td style="text-align:left;background-color: rgba(255, 240, 245, 255) !important;">
54 x 0.41 + 80 x 0.39 = 53.34
</td>
</tr>
<tr>
<td style="text-align:left;background-color: aquamarine !important;">
NO0A
</td>
<td style="text-align:left;background-color: aquamarine !important;">
2021
</td>
<td style="text-align:left;background-color: rgba(255, 240, 245, 255) !important;">
80 x 0.61 + 41 x 1 = 89.8
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level4">
<h4 id="conversion-of-relative-values-between-versions">Conversion of relative values between versions<a class="anchor" aria-label="anchor" href="#conversion-of-relative-values-between-versions"></a>
</h4>
<p>To convert <strong>relative</strong> values, such as the number of patent applications per 1000 inhabitants, <code><a href="../reference/nuts_convert_version.html">nuts_convert_version()</a></code> departs again from the conversion table seen above. We focus on the variable <code>P_MHAB</code>, patent applications per one million inhabitants. The function summarizes these relative values by computing the <strong>weighted average</strong> with respect to 2018 population flows.</p>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
to_code
</th>
<th style="text-align:left;">
to_version
</th>
<th style="text-align:left;">
P_MHAB
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;background-color: aquamarine !important;">
NO02
</td>
<td style="text-align:left;background-color: aquamarine !important;">
2021
</td>
<td style="text-align:left;background-color: rgba(255, 240, 245, 255) !important;">
(370 x 13)/(370) = 13
</td>
</tr>
<tr>
<td style="text-align:left;background-color: aquamarine !important;">
NO06
</td>
<td style="text-align:left;background-color: aquamarine !important;">
2021
</td>
<td style="text-align:left;background-color: rgba(255, 240, 245, 255) !important;">
(3 x 48 + 447 x 145)/(3 + 447) = 144
</td>
</tr>
<tr>
<td style="text-align:left;background-color: aquamarine !important;">
NO07
</td>
<td style="text-align:left;background-color: aquamarine !important;">
2021
</td>
<td style="text-align:left;background-color: rgba(255, 240, 245, 255) !important;">
(452 x 16)/(452) = 16
</td>
</tr>
<tr>
<td style="text-align:left;background-color: aquamarine !important;">
NO08
</td>
<td style="text-align:left;background-color: aquamarine !important;">
2021
</td>
<td style="text-align:left;background-color: rgba(255, 240, 245, 255) !important;">
(1268 x 125 + 15 x 13 + 575 x 57)/(1268 + 15 + 575) = 103
</td>
</tr>
<tr>
<td style="text-align:left;background-color: aquamarine !important;">
NO09
</td>
<td style="text-align:left;background-color: aquamarine !important;">
2021
</td>
<td style="text-align:left;background-color: rgba(255, 240, 245, 255) !important;">
(403 x 57 + 292 x 110)/(403 + 292) = 79
</td>
</tr>
<tr>
<td style="text-align:left;background-color: aquamarine !important;">
NO0A
</td>
<td style="text-align:left;background-color: aquamarine !important;">
2021
</td>
<td style="text-align:left;background-color: rgba(255, 240, 245, 255) !important;">
(451 x 110 + 837 x 48)/(451 + 837) = 70
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level4">
<h4 id="conversion-of-absolute-values-between-nuts-levels">Conversion of absolute values between NUTS levels<a class="anchor" aria-label="anchor" href="#conversion-of-absolute-values-between-nuts-levels"></a>
</h4>
<p>The function <code><a href="../reference/nuts_aggregate.html">nuts_aggregate()</a></code> aggregates from lower to higher order <strong>levels</strong>, e.g. from NUTS-3 to NUTS-2. Since higher order regions are perfectly split into lower order regions in the NUTS system, the function takes simply the sum of the values in case of <strong>absolute</strong> variables.</p>
</div>
<div class="section level4">
<h4 id="conversion-of-relative-values-between-nuts-levels">Conversion of relative values between NUTS levels<a class="anchor" aria-label="anchor" href="#conversion-of-relative-values-between-nuts-levels"></a>
</h4>
<p><strong>Relative</strong> values are aggregated in <code><a href="../reference/nuts_aggregate.html">nuts_aggregate()</a></code> by computing the weighted mean of all lower order regional <strong>levels</strong>. To convert, for example, the number of patent applications per one million inhabitants from NUTS-3 to NUTS-2, the function adds the population size in 2018.</p>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
nuts_3
</th>
<th style="text-align:left;">
nuts_2
</th>
<th style="text-align:right;">
pop18
</th>
<th style="text-align:right;">
P_MHAB
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO011
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO01
</td>
<td style="text-align:right;">
662
</td>
<td style="text-align:right;">
145
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO012
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO01
</td>
<td style="text-align:right;">
606
</td>
<td style="text-align:right;">
102
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO021
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO02
</td>
<td style="text-align:right;">
196
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO022
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO02
</td>
<td style="text-align:right;">
188
</td>
<td style="text-align:right;">
18
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO031
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO03
</td>
<td style="text-align:right;">
289
</td>
<td style="text-align:right;">
34
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO032
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO03
</td>
<td style="text-align:right;">
279
</td>
<td style="text-align:right;">
45
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO033
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO03
</td>
<td style="text-align:right;">
239
</td>
<td style="text-align:right;">
106
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO034
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO03
</td>
<td style="text-align:right;">
169
</td>
<td style="text-align:right;">
45
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO041
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO04
</td>
<td style="text-align:right;">
113
</td>
<td style="text-align:right;">
43
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO042
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO04
</td>
<td style="text-align:right;">
178
</td>
<td style="text-align:right;">
50
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO043
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO04
</td>
<td style="text-align:right;">
451
</td>
<td style="text-align:right;">
150
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO051
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO05
</td>
<td style="text-align:right;">
495
</td>
<td style="text-align:right;">
24
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO052
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO05
</td>
<td style="text-align:right;">
102
</td>
<td style="text-align:right;">
58
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO053
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO05
</td>
<td style="text-align:right;">
241
</td>
<td style="text-align:right;">
91
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO061
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO06
</td>
<td style="text-align:right;">
307
</td>
<td style="text-align:right;">
208
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO062
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO06
</td>
<td style="text-align:right;">
139
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO071
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO07
</td>
<td style="text-align:right;">
225
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;background-color: azure !important;">
NO072
</td>
<td style="text-align:left;background-color: aquamarine !important;">
NO07
</td>
<td style="text-align:right;">
154
</td>
<td style="text-align:right;">
33
</td>
</tr>
</tbody>
</table>
</div>
<p>The number of patent applications at the NUTS-2 level is computed by the <strong>weighted average</strong> using NUTS-3 population numbers.</p>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
nuts_2
</th>
<th style="text-align:left;">
P_MHAB
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;background-color: aquamarine !important;">
NO01
</td>
<td style="text-align:left;background-color: rgba(255, 240, 245, 255) !important;">
(662 x 145 + 606 x 102)/(662 + 606) = 124
</td>
</tr>
<tr>
<td style="text-align:left;background-color: aquamarine !important;">
NO02
</td>
<td style="text-align:left;background-color: rgba(255, 240, 245, 255) !important;">
(196 x 7 + 188 x 18)/(196 + 188) = 12
</td>
</tr>
<tr>
<td style="text-align:left;background-color: aquamarine !important;">
NO03
</td>
<td style="text-align:left;background-color: rgba(255, 240, 245, 255) !important;">
(289 x 34 + 279 x 45 + 239 x 106 + 169 x 45)/(289 + 279 + 239 + 169) = 56
</td>
</tr>
<tr>
<td style="text-align:left;background-color: aquamarine !important;">
NO04
</td>
<td style="text-align:left;background-color: rgba(255, 240, 245, 255) !important;">
(113 x 43 + 178 x 50 + 451 x 150)/(113 + 178 + 451) = 109
</td>
</tr>
<tr>
<td style="text-align:left;background-color: aquamarine !important;">
NO05
</td>
<td style="text-align:left;background-color: rgba(255, 240, 245, 255) !important;">
(495 x 24 + 102 x 58 + 241 x 91)/(495 + 102 + 241) = 47
</td>
</tr>
<tr>
<td style="text-align:left;background-color: aquamarine !important;">
NO06
</td>
<td style="text-align:left;background-color: rgba(255, 240, 245, 255) !important;">
(307 x 208 + 139 x 3)/(307 + 139) = 144
</td>
</tr>
<tr>
<td style="text-align:left;background-color: aquamarine !important;">
NO07
</td>
<td style="text-align:left;background-color: rgba(255, 240, 245, 255) !important;">
(225 x 10 + 154 x 33)/(225 + 154) = 19
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>Please support the development of open science and data by citing the JRC and us in your work:</p>
<ul>
<li><p>Joint Research Centre (2022) NUTS converter. <a href="https://urban.jrc.ec.europa.eu/tools/nuts-converter" class="external-link uri">https://urban.jrc.ec.europa.eu/tools/nuts-converter</a></p></li>
<li><p>Hennicke M, Krause W (2024). <em>nuts: Convert European Regional Data</em>. <a href="doi:10.5281/zenodo.10885973" class="uri">doi:10.5281/zenodo.10885973</a> <a href="https://doi.org/10.5281/zenodo.10573057" class="external-link uri">https://doi.org/10.5281/zenodo.10573057</a>, R package version 1.0.0, <a href="https://docs.ropensci.org/nuts/" class="uri">https://docs.ropensci.org/nuts/</a>.</p></li>
</ul>
<p>Bibtex Users:</p>
<pre><code>@Manual{,
  title = {NUTS converter},
  author = {Joint Research Centre},
  year = {2022},
  url = {https://urban.jrc.ec.europa.eu/tools/nuts-converter},
}

@Manual{,
  title = {nuts: Convert European Regional Data},
  author = {Moritz Hennicke and Werner Krause},
  year = {2024},
  note = {R package version 1.0.0},
  url = {https://docs.ropensci.org/nuts/},
  doi = {https://doi.org/10.5281/zenodo.10885973},
}</code></pre>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
